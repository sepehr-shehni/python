import time
from netmiko import ConnectHandler

# Constants for device login credentials and file containing IP addresses
IP_FILE = "IP.txt"
USERNAME = "admin"
PASSWORD = "cisco"
ENABLE_PASS = "cisco"

def configure_device(host):
    # Define device parameters for the connection
    device = {
        'device_type': 'cisco_ios',
        'host': host,
        'username': USERNAME,
        'password': PASSWORD,
        'secret': ENABLE_PASS,
    }
    try:
        # Establish SSH connection to the device
        connection = ConnectHandler(**device)
        # Enter enable mode
        connection.enable()
        # Send configuration commands
        connection.send_config_set(['hostname Pythonnetwork'])
        # Disconnect the SSH session
        connection.disconnect()
        print(f"Successfully configured {host}")
    except Exception as e:
        print(f"Failed to configure {host}: {e}")

def main():
    # Open the file with IP addresses and read lines
    with open(IP_FILE) as file:
        ips = file.readlines()

    # Use a while loop to iterate through the list of IPs
    index = 0
    while index < len(ips):
        host = ips[index].strip()
        configure_device(host)
        index += 1

# Entry point of the script
if __name__ == "__main__":
    main()